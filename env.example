# ============================================================================
# Shield Platform - Environment Configuration Template
# ============================================================================
#
# SECURITY NOTICE: This is a template file. DO NOT commit .env to version control!
#
# Instructions:
# 1. Copy this file to .env
# 2. Replace all placeholder values with real values
# 3. Generate secure secrets using: node -e "console.log(require('crypto').randomBytes(64).toString('base64'))"
# 4. Keep .env file secure and never share it
#
# For production deployment, use a secrets management service (AWS Secrets Manager, HashiCorp Vault, etc.)
# ============================================================================

# ============================================================================
# Environment
# ============================================================================
NODE_ENV=development
# Options: development, production, test
# Production mode enforces stricter security policies

# ============================================================================
# Database Configuration (PostgreSQL)
# ============================================================================
# CRITICAL: Use strong passwords and SSL in production

POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=shield_user
POSTGRES_PASSWORD=CHANGE_ME_USE_STRONG_PASSWORD_MIN_16_CHARS_WITH_SPECIAL_CHARS_123!@#
POSTGRES_DB=shield_platform

# Full database URL (alternative to individual settings)
# Format: postgresql://user:password@host:port/database?ssl=true
DATABASE_URL=postgresql://shield_user:CHANGE_ME_USE_STRONG_PASSWORD_MIN_16_CHARS_WITH_SPECIAL_CHARS_123!@#@localhost:5432/shield_platform

# Production: Add ?ssl=true or ?sslmode=require to DATABASE_URL
# DATABASE_URL=postgresql://user:pass@host:5432/db?sslmode=require

# ============================================================================
# JWT Authentication (CRITICAL SECURITY SETTINGS)
# ============================================================================
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('base64'))"
# IMPORTANT: These MUST be different from each other and at least 64 characters

JWT_SECRET=CHANGE_ME_GENERATE_RANDOM_64_CHAR_STRING_FOR_ACCESS_TOKENS_EXAMPLE_abc123XYZ!@#
JWT_REFRESH_SECRET=CHANGE_ME_GENERATE_DIFFERENT_RANDOM_64_CHAR_STRING_FOR_REFRESH_TOKENS_def456UVW!@#

# Token expiration times
# Format: 15m (minutes), 1h (hours), 7d (days)
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# ============================================================================
# Encryption (CRITICAL - Protects data at rest)
# ============================================================================
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# This encrypts sensitive data in the database

ENCRYPTION_KEY=CHANGE_ME_GENERATE_BASE64_ENCODED_32_BYTE_KEY_FOR_AES_256_ENCRYPTION
ENCRYPTION_ALGORITHM=aes-256-gcm

# Session secret for CSRF tokens
SESSION_SECRET=CHANGE_ME_GENERATE_RANDOM_64_CHAR_STRING_FOR_SESSION_MANAGEMENT

# ============================================================================
# Service Ports
# ============================================================================
# Each microservice runs on its own port

API_GATEWAY_PORT=8080
AUTH_SERVICE_PORT=3001
WALLET_SERVICE_PORT=3002
TRANSACTION_SERVICE_PORT=3003
BLOCKCHAIN_SERVICE_PORT=3004
COMPLIANCE_SERVICE_PORT=3005

# Generic PORT variable (used by individual services)
PORT=3000

# ============================================================================
# Service URLs (Internal Communication)
# ============================================================================
# These URLs are used by the API Gateway to route requests

AUTH_SERVICE_URL=http://localhost:3001
WALLET_SERVICE_URL=http://localhost:3002
TRANSACTION_SERVICE_URL=http://localhost:3003
BLOCKCHAIN_SERVICE_URL=http://localhost:3004
COMPLIANCE_SERVICE_URL=http://localhost:3005

# Production: Use internal service discovery or DNS
# AUTH_SERVICE_URL=http://auth-service:3001
# WALLET_SERVICE_URL=http://wallet-service:3002

# ============================================================================
# CORS Configuration
# ============================================================================
# CRITICAL: Never use * in production!

# Development
CORS_ORIGIN=http://localhost:3000

# Production: Specify exact domains
# CORS_ORIGIN=https://app.shield-platform.com,https://admin.shield-platform.com

CORS_CREDENTIALS=true

# ============================================================================
# Rate Limiting (DDoS Protection)
# ============================================================================

# Time window in milliseconds (15 minutes = 900000)
RATE_LIMIT_WINDOW_MS=900000

# Maximum requests per window per IP
RATE_LIMIT_MAX_REQUESTS=100

# Production: Use stricter limits
# RATE_LIMIT_MAX_REQUESTS=50

# ============================================================================
# Redis (Required for Production - Distributed Rate Limiting & Caching)
# ============================================================================
# Optional in development, REQUIRED in production for multi-instance deployments

REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
# REDIS_URL=redis://:password@redis-host:6379

# Redis connection pool
REDIS_MAX_CLIENTS=50
REDIS_MIN_CLIENTS=10

# ============================================================================
# Password Security Requirements
# ============================================================================

PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true

# Minimum password entropy in bits (60 = strong, 80 = very strong)
PASSWORD_MIN_ENTROPY=60

# Bcrypt rounds (12-15 recommended, higher = slower but more secure)
BCRYPT_ROUNDS=12

# ============================================================================
# Brute Force Protection
# ============================================================================

# Maximum failed login attempts before lockout
MAX_LOGIN_ATTEMPTS=5

# How long to track login attempts (15 minutes = 900000 ms)
LOGIN_WINDOW_MS=900000

# Account lockout duration after max attempts (15 minutes = 900000 ms)
ACCOUNT_LOCKOUT_DURATION_MS=900000

# ============================================================================
# Blockchain Configuration (Polygon)
# ============================================================================

# Polygon RPC URLs (use your own Infura/Alchemy endpoint)
POLYGON_RPC_URL=https://polygon-rpc.com
# POLYGON_RPC_URL=https://polygon-mainnet.infura.io/v3/YOUR_INFURA_KEY

POLYGON_CHAIN_ID=137
# Mainnet: 137, Mumbai Testnet: 80001

# USDT contract address on Polygon
POLYGON_USDT_CONTRACT=0xc2132D05D31c914a87C6611C10748AEb04B58e8F

# Shield's Polygon wallet (receives payments)
SHIELD_POLYGON_WALLET_ADDRESS=0xYOUR_WALLET_ADDRESS_HERE
SHIELD_POLYGON_WALLET_PRIVATE_KEY=YOUR_PRIVATE_KEY_HERE_KEEP_VERY_SECURE

# Gas settings
GAS_PRICE_MULTIPLIER=1.2
MAX_GAS_PRICE=500

# ============================================================================
# Blockchain Configuration (Tron)
# ============================================================================

# Tron RPC URLs
TRON_RPC_URL=https://api.trongrid.io
# Testnet: https://api.shasta.trongrid.io

TRON_CHAIN_ID=1
# Mainnet: 1, Shasta Testnet: 2

# USDT contract address on Tron (TRC20)
TRON_USDT_CONTRACT=TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t

# Shield's Tron wallet (receives payments)
SHIELD_TRON_WALLET_ADDRESS=TYOUR_WALLET_ADDRESS_HERE
SHIELD_TRON_WALLET_PRIVATE_KEY=YOUR_PRIVATE_KEY_HERE_KEEP_VERY_SECURE

# ============================================================================
# Transaction Limits (Compliance & Risk Management)
# ============================================================================

# Maximum transaction amount in USDT
MAX_TRANSACTION_AMOUNT=1000000

# Minimum transaction amount in USDT
MIN_TRANSACTION_AMOUNT=0.01

# Transactions above this amount require manual approval
TRANSACTION_APPROVAL_REQUIRED_ABOVE=100000

# Enable real-time transaction monitoring
ENABLE_TRANSACTION_MONITORING=true

# ============================================================================
# Security Headers
# ============================================================================

# HTTP Strict Transport Security max age (1 year = 31536000 seconds)
HSTS_MAX_AGE=31536000

# Content Security Policy
CSP_ENABLED=true

# ============================================================================
# API Security
# ============================================================================

# Require API keys for service-to-service communication
REQUIRE_API_KEY=false

# API key rotation period in days
API_KEY_ROTATION_DAYS=90

# Gateway timeout in milliseconds
GATEWAY_TIMEOUT_MS=30000

# Enable request validation
ENABLE_REQUEST_VALIDATION=true

# ============================================================================
# Logging & Monitoring
# ============================================================================

# Log level: error, warn, info, debug
LOG_LEVEL=info

# Audit logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=standard
# Options: minimal, standard, detailed

# Service identification
SERVICE_NAME=shield-platform
SERVICE_VERSION=1.0.0

# ============================================================================
# External Services (Optional)
# ============================================================================

# Email service (for notifications, 2FA)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-app-password
# SMTP_FROM=noreply@shield-platform.com

# SMS service (for 2FA)
# TWILIO_ACCOUNT_SID=
# TWILIO_AUTH_TOKEN=
# TWILIO_PHONE_NUMBER=

# KYC/AML service
# JUMIO_API_TOKEN=
# JUMIO_API_SECRET=

# ============================================================================
# Monitoring & Observability
# ============================================================================

# Sentry (Error tracking)
# SENTRY_DSN=

# DataDog (APM)
# DD_API_KEY=
# DD_APP_KEY=

# CloudWatch (AWS)
# AWS_REGION=us-east-1
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=

# ============================================================================
# Feature Flags
# ============================================================================

ENABLE_2FA=true
ENABLE_EMAIL_VERIFICATION=true
ENABLE_KYC=true
ENABLE_WITHDRAWAL_WHITELIST=true

# ============================================================================
# Development Settings (Remove in production)
# ============================================================================

# Enable debug mode (verbose logging)
DEBUG=false

# Skip SSL verification (NEVER in production)
NODE_TLS_REJECT_UNAUTHORIZED=1

# ============================================================================
# Production Checklist
# ============================================================================
#
# Before deploying to production, ensure:
#
# [ ] All secrets are randomly generated and at least 64 characters
# [ ] JWT_SECRET and JWT_REFRESH_SECRET are different
# [ ] Database uses SSL (add ?ssl=true to DATABASE_URL)
# [ ] CORS_ORIGIN is set to specific domains (not *)
# [ ] NODE_ENV is set to "production"
# [ ] Private keys are stored in secure key management system
# [ ] Redis is configured for distributed operations
# [ ] Rate limiting is enabled and configured
# [ ] Monitoring and logging services are configured
# [ ] Backups are automated
# [ ] SSL/TLS certificates are valid
# [ ] Firewall rules are configured
# [ ] DDoS protection is enabled (CloudFlare, AWS Shield, etc.)
#
# ============================================================================

# ============================================================================
# Security Best Practices
# ============================================================================
#
# 1. Secret Management:
#    - Use AWS Secrets Manager, HashiCorp Vault, or similar
#    - Rotate secrets every 90 days
#    - Never commit .env to git
#    - Use different secrets for dev/staging/prod
#
# 2. Database Security:
#    - Always use SSL in production
#    - Restrict database access by IP
#    - Use strong passwords (20+ characters)
#    - Enable audit logging
#    - Regular backups with encryption
#
# 3. API Security:
#    - Enable rate limiting
#    - Use API keys for service-to-service calls
#    - Implement request signing
#    - Monitor for suspicious patterns
#
# 4. Network Security:
#    - Use VPC/private networks
#    - Enable WAF (Web Application Firewall)
#    - Use DDoS protection
#    - Implement IP whitelisting where appropriate
#
# 5. Compliance:
#    - Enable audit logging
#    - Implement data retention policies
#    - Regular security audits
#    - PCI DSS compliance for payment data
#
# ============================================================================


